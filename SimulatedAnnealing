import java.util.*;

import javax.print.attribute.ResolutionSyntax;

public class SimulatedAnnealing {
	private CandidateSolution CS;
	public SimulatedAnnealing(PreferenceTable p) {
		CS = new CandidateSolution(p);
	}

	public CandidateSolution saSolution(){
		int newEnergy;
		int currentEnergy = CS.getEnergy();
		for(double temp = 1000; temp >= 0; temp -= 0.0001){
			Random RND = new Random();
			int num = RND.nextInt(CS.getAllCandiates().size());

			CandidateAssignment C = CS.getAllCandiates().get(num);
			C.randomiseAssignment();
			CS.getAllCandiates().setElementAt(C, num);
			newEnergy = CS.getEnergy();
			
			double changeInEnergy = currentEnergy - newEnergy;

			if(newEnergy >= currentEnergy && !(boltzmann(temp, changeInEnergy))){
				C.undoChange();
				CS.getAllCandiates().setElementAt(C, num);
			}

			else{
				currentEnergy = newEnergy;
			}
		}
		System.out.println("ENERGY: " + CS.getEnergy());
		return CS;
	}
	
	private boolean boltzmann(double temp, double change){
		Random RND = new Random();
		double randNum = RND.nextDouble();
		
		double boltzmann = (Math.exp((change/temp)));
		
		if(boltzmann > randNum){
			return true;
		}
		else{
			return false;
		}
	}
	

}
